gene_list <- genes(TxDb.Hsapiens.UCSC.hg19.knownGene) %>%
as.data.table()
gene_list[, subjectHits := .I]
gtp <- fread("file:///D:/Dropbox/Dropbox/GitHub/neanderthal-sqtl/scratch/LIVER.permutations_full.txt.gz") %>%
setnames(., c("intron_cluster", "chrom", "pheno_start", "pheno_end",
"strand", "total_cis", "distance", "variant_id", "variant_chrom",
"var_start", "var_end", "df", "dummy", "param_1", "param_2",
"p", "beta", "emp_p", "adj_p")) %>%
setorder(., adj_p)
gtp[, qval := qvalue(gtp$adj_p)$qvalue]
neand <- fread("file:///D:/Dropbox/Dropbox/GitHub/neanderthal-sqtl/analysis/SPRIME/sprime_calls.txt]")[vindija_match == "match" | altai_match == "match"] %>%
mutate(., var_id_1 = paste(CHROM, POS, REF, ALT, "b37", sep = "_")) %>%
as.data.table()
neand_list <- c(neand$var_id_1, neand$var_id_2)
gtp[, is_neand := variant_id %in% neand_list]
gtp[qval < 0.1 & is_neand == TRUE]
coords_gr <- gtp[, c("chrom", "pheno_start", "pheno_end")] %>%
mutate(., chrom = paste0("chr", chrom)) %>%
makeGRangesFromDataFrame
olaps <- findOverlaps(coords_gr, genes(TxDb.Hsapiens.UCSC.hg19.knownGene)) %>%
as.data.table()
gtp[, queryHits := .I]
gtp <- gtp[olaps, on = "queryHits", nomatch = 0]
gtp <- gtp[gene_list, on = "subjectHits", nomatch = 0]
setorder(gtp, adj_p)
table <- gtp[qval < 0.1 & is_neand == TRUE]
library(data.table)
library(tidyverse)
library(Homo.sapiens)
library(qqman)
library(qvalue)
gene_list <- genes(TxDb.Hsapiens.UCSC.hg19.knownGene) %>%
as.data.table()
gene_list[, subjectHits := .I]
gtp <- fread("file:///D:/Dropbox/Dropbox/GitHub/neanderthal-sqtl/scratch/LIVER.permutations_full.txt.gz") %>%
setnames(., c("intron_cluster", "chrom", "pheno_start", "pheno_end",
"strand", "total_cis", "distance", "variant_id", "variant_chrom",
"var_start", "var_end", "df", "dummy", "param_1", "param_2",
"p", "beta", "emp_p", "adj_p")) %>%
setorder(., adj_p)
gtp[, qval := qvalue(gtp$adj_p)$qvalue]
neand <- fread("file:///D:/Dropbox/Dropbox/GitHub/neanderthal-sqtl/analysis/SPRIME/sprime_calls.txt]")[vindija_match == "match" | altai_match == "match"] %>%
mutate(., var_id_1 = paste(CHROM, POS, REF, ALT, "b37", sep = "_")) %>%
as.data.table()
neand_list <- c(neand$var_id_1, neand$var_id_2)
gtp[, is_neand := variant_id %in% neand_list]
gtp[qval < 0.1 & is_neand == TRUE]
coords_gr <- gtp[, c("chrom", "pheno_start", "pheno_end")] %>%
mutate(., chrom = paste0("chr", chrom)) %>%
makeGRangesFromDataFrame
olaps <- findOverlaps(coords_gr, genes(TxDb.Hsapiens.UCSC.hg19.knownGene)) %>%
as.data.table()
gtp[, queryHits := .I]
gtp <- gtp[olaps, on = "queryHits", nomatch = 0]
gtp <- gtp[gene_list, on = "subjectHits", nomatch = 0]
setorder(gtp, adj_p)
table <- gtp[qval < 0.1 & is_neand == TRUE]
?sapply
names(NE) <- sapply(strsplit(names(NE)"GTEX-ZZPU-2726-SM-5NQ8O.Aligned.sortedByCoord.out.patched_filtered.junc.Ne-sQTL.sorted.gz", "."), '[', 1)
names(NE) <- sapply(strsplit("GTEX-ZZPU-2726-SM-5NQ8O.Aligned.sortedByCoord.out.patched_filtered.junc.Ne-sQTL.sorted.gz", "."), '[', 1)
sapply(strsplit("GTEX-ZZPU-2726-SM-5NQ8O.Aligned.sortedByCoord.out.patched_filtered.junc.Ne-sQTL.sorted.gz", "."), '[', 1)
sapply(strsplit("GTEX-ZZPU-2726-SM-5NQ8O.Aligned.sortedByCoord.out.patched_filtered.junc.Ne-sQTL.sorted.gz", "."))
